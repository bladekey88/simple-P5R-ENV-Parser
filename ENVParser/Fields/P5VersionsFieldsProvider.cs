namespace ENVParser.Fields
{
    internal class P5VersionsFieldsProvider
    {
        public static List<string> GetP5UniqueVersionFields(uint GFSVersion)
        {
            List<string> fieldNames = []; ;
            foreach (var kvp in _P5FieldsVersionMapping)
            {
                if (kvp.Value.Contains(GFSVersion))
                {
                    fieldNames.Add(kvp.Key);
                }
            }
            return fieldNames;
        }

        private static readonly uint[] ALL_VERSIONS = [
            17846608,  // This is P5R Only
            17842688,
            17842768,
            17843456,
            17843712,
            17843968,
            17844224,
            17844480,
            17844496,
            17844512,
            17844544,
            17844560,
            17844576,
            17844592,
            17844624,
            17846272,
            17846288,
            17846304,
            17846320,
            17846336,
            17846352,
            17846368,
            17846384,   // This is P5V Only
            17846336    // This is P4D Only
        ];

        private static readonly Dictionary<string, uint[]> _P5FieldsVersionMapping = new()
        {
            {"Env Header", ALL_VERSIONS },
            {"FileMagic", ALL_VERSIONS},
            {"GFSVersion", ALL_VERSIONS},
            {"FileType", ALL_VERSIONS},
            {"Field0C", ALL_VERSIONS},
            {"LightType", ALL_VERSIONS },
            {"Field Model Light 0", ALL_VERSIONS },
            {"Field Model Light 1", ALL_VERSIONS },
            {"Field Model Light 2", ALL_VERSIONS },
            {"EnableFieldModelSection", ALL_VERSIONS},
            {"FieldModelAmbientRed", ALL_VERSIONS},
            {"FieldModelAmbientGreen", ALL_VERSIONS},
            {"FieldModelAmbientBlue", ALL_VERSIONS},
            {"FieldModelAmbientAlpha", ALL_VERSIONS},
            {"FieldModelDiffuseRed", ALL_VERSIONS},
            {"FieldModelDiffuseGreen", ALL_VERSIONS},
            {"FieldModelDiffuseBlue", ALL_VERSIONS},
            {"FieldModelDiffuseAlpha",ALL_VERSIONS},
            {"FieldModelSpecularRed", ALL_VERSIONS},
            {"FieldModelSpecularGreen", ALL_VERSIONS},
            {"FieldModelSpecularBlue", ALL_VERSIONS},
            {"FieldModelSpecularAlpha", ALL_VERSIONS},
            {"FieldModelEmissiveRed", ALL_VERSIONS},
            {"FieldModelEmissiveGreen",ALL_VERSIONS},
            {"FieldModelEmissiveBlue", ALL_VERSIONS},
            {"FieldModelEmissiveAlpha", ALL_VERSIONS},
            {"Field52", ALL_VERSIONS},
            {"Field56", ALL_VERSIONS},
            {"Field5A", ALL_VERSIONS},
            {"Field5E", ALL_VERSIONS},
            {"FieldModelLightX", ALL_VERSIONS},
            {"FieldModelLightY", ALL_VERSIONS},
            {"FieldModelLightZ", ALL_VERSIONS},
            {"UnusedTextureSection", ALL_VERSIONS},
            {"Character Model Light", ALL_VERSIONS },
            {"Field12A", RemoveVersionsFromArray(ALL_VERSIONS,[17842688])},
            {"EnableCharacterModelSection", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelAmbientRed", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelAmbientGreen", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelAmbientBlue", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelAmbientAlpha", RemoveVersionsFromArray(ALL_VERSIONS,[17842688])},
            {"CharacterModelDiffuseRed", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelDiffuseGreen", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelDiffuseBlue", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelDiffuseAlpha", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelSpecularRed", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelSpecularGreen", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelSpecularBlue", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelSpecularAlpha", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelEmissiveRed", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelEmissiveGreen", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelEmissiveBlue", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelEmissiveAlpha", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"Field16C", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"Field170", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"Field174", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"Field178", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelLightX", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelLightY", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"CharacterModelLightZ", RemoveVersionsFromArray(ALL_VERSIONS, [17842688])},
            {"Field188", ALL_VERSIONS},
            {"ModelNearClip", ALL_VERSIONS},
            {"ModelFarClip", ALL_VERSIONS},
            {"Fog", ALL_VERSIONS },
            {"EnableFog", ALL_VERSIONS},
            {"EnableAmbientFog",ALL_VERSIONS},
            {"DisableFog", ALL_VERSIONS},
            {"ToggleFogCameraPlane", ALL_VERSIONS},
            {"FogStartDistance", ALL_VERSIONS},
            {"FogEndDistance", ALL_VERSIONS},
            {"FogRed", ALL_VERSIONS},
            {"FogGreen", ALL_VERSIONS},
            {"FogBlue", ALL_VERSIONS},
            {"FogAlpha", ALL_VERSIONS},
            {"EnableFloorFog", ALL_VERSIONS},
            {"FloorFogStartingHeight", ALL_VERSIONS},
            {"FloorFogEndHeight", ALL_VERSIONS},
            {"FloorFogRed", ALL_VERSIONS},
            {"FloorFogGreen", ALL_VERSIONS},
            {"FloorFogBlue", ALL_VERSIONS},
            {"FloorFogOpacity", ALL_VERSIONS},
            {"Global Lighting Effects", ALL_VERSIONS },
            {"EnableGraphicOutput", ALL_VERSIONS},
            {"EnableBloom", ALL_VERSIONS},
            {"EnableGlare", ALL_VERSIONS},
            {"Field1CC", ALL_VERSIONS},
            {"Field1CD",[17846608]},
            {"Field1CE",[17846608]},
            {"Field1CF",[17846608]},
            {"Field1D0",[17846608]},
            {"BloomAmount", ALL_VERSIONS},
            {"BloomDetail", ALL_VERSIONS},
            {"BloomWhiteLevel", ALL_VERSIONS},
            {"BloomDarkLevel", ALL_VERSIONS},
            {"GlareSensitivity", ALL_VERSIONS},
            {"SceneWhiteLevels",[17846608]},
            {"SceneDarkLevels",[17846608]},
            {"Field1F0",[17846608]},
            {"Field1F4",[17846608]},
            {"Field1F8",[17846608]},
            {"Field1FC",[17846608]},
            {"Field200",[17846608]},
            {"Field204",[17846608]},
            {"Field208",[17846608]},
            {"Field20C",[17846608]},
            {"Field210",[17846608]},
            {"Field214",[17846608]},
            {"RedColourBoost",[17846608]},
            {"GreenColourBoost",[17846608]},
            {"BlueColourBoost",[17846608]},
            {"Field224",[17846608]},
            {"Field228",[17846608]},
            {"Field22C",[17846608]},
            {"Field230",[17846608]},
            {"Field234",[17846608]},
            {"Field238",[17846608]},
            {"Field23C",[17846608]},
            {"GlareLength", RemoveVersionsFromArray(ALL_VERSIONS, [17842688,17842768])},
            {"GlareChromaticAberration", RemoveVersionsFromArray(ALL_VERSIONS, [17842688,17842768])},
            {"GlareDirection", RemoveVersionsFromArray(ALL_VERSIONS, [17842688,17842768])},
            {"GlareMode", RemoveVersionsFromArray(ALL_VERSIONS, [17842688,17842768])},
            {"Unknown Section", ALL_VERSIONS },
            {"Field250", [17846352, 17846368, 17846384, 17846608]},
            {"Field251", [17846352, 17846368, 17846384, 17846608]},
            {"Field255",[17846608]},
            {"Field259", [17846352, 17846368, 17846384, 17846608]},
            {"Field25D", [17846352, 17846368, 17846384, 17846608]},
            {"EnableDOF", ALL_VERSIONS},
            {"DOF_FocalPlane", ALL_VERSIONS},
            {"DOF_NearBlurPlane", ALL_VERSIONS},
            {"DOF_FarBlurPlane", ALL_VERSIONS},
            {"DOF_FarBlurLimit", ALL_VERSIONS},
            {"DOF_BlurScale", ALL_VERSIONS},
            {"DOF_GaussType",[17846288, 17846304, 17846320, 17846336, 17846352, 17846368, 17846384, 17846608]},
            {"EnableSSAO", ALL_VERSIONS},
            {"SSAO_OccluderRadius", ALL_VERSIONS},
            {"SSAO_FallOffRadius", ALL_VERSIONS},
            {"SSAO_BlurScale", ALL_VERSIONS},
            {"SSAO_Brightness", ALL_VERSIONS},
            {"SSAO_DepthRange", ALL_VERSIONS},
            {"DisableUnknownFlaggedSection", ALL_VERSIONS},
            {"Field Shadows", ALL_VERSIONS },
            {"FieldShadowFarClip", ALL_VERSIONS},
            {"Field294", ALL_VERSIONS},
            {"AmbientShadowBrightness", ALL_VERSIONS},
            {"Field29C", ALL_VERSIONS},
            {"Field2A0", ALL_VERSIONS},
            {"FieldShadowNearClip", ALL_VERSIONS},
            {"FieldShadowBrightness", ALL_VERSIONS},
            {"Field2AC", ALL_VERSIONS},
            {"Field2AD", ALL_VERSIONS},
            {"Field2AE", ALL_VERSIONS},
            {"Field2AF", ALL_VERSIONS},
            {"Field Shadows Colour", [17846608] },
            {"ShadowColourRed",[17846608]},
            {"ShadowColourGreen",[17846608]},
            {"ShadowColourBlue",[17846608]},
            {"ShadowColourAlpha",[17846608]},
            {"Colour Corrections", ALL_VERSIONS },
            {"DisplayColourGrading", ALL_VERSIONS},
            {"Cyan", ALL_VERSIONS},
            {"Magenta", ALL_VERSIONS},
            {"Yellow", ALL_VERSIONS},
            {"Dodge", ALL_VERSIONS},
            {"Burn", ALL_VERSIONS},
            {"Second Unknown Section", ALL_VERSIONS },
            {"LightMapR", ALL_VERSIONS},
            {"LightMapG", ALL_VERSIONS},
            {"LightMapB", ALL_VERSIONS},
            {"LightMapA", ALL_VERSIONS},
            {"EnableOutline", ALL_VERSIONS},
            {"OutlineOpacity", ALL_VERSIONS},
            {"OutlineWidth", ALL_VERSIONS},
            {"CharacterOutlineBrightness", RemoveVersionsFromArray(ALL_VERSIONS, [17842688, 17842768, 17843456, 17843712, 17843968, 17844224, 17844480, 17844496, 17844512, 17844544 , 17844560, 17844576])},
            {"Field2F2", [17846320, 17846336, 17846352, 17846368, 17846384, 17846608]},
            {"Field2F6", [17846320, 17846336, 17846352, 17846368, 17846384, 17846608]},
            {"ReflectionHeight", ALL_VERSIONS},
            {"Physics", ALL_VERSIONS },
            {"EnablePhysicsSection", ALL_VERSIONS},
            {"Gravity", ALL_VERSIONS},
            {"EnableWind", ALL_VERSIONS},
            {"WindDirectionX", ALL_VERSIONS},
            {"WindDirectionY", ALL_VERSIONS},
            {"WindDirectionZ", ALL_VERSIONS},
            {"WindStrength", ALL_VERSIONS},
            {"WindStrengthModifier", ALL_VERSIONS},
            {"WindCycleTime", ALL_VERSIONS},
            {"WindCycleDelay", ALL_VERSIONS},
            {"Clear Colours", ALL_VERSIONS },
            {"ClearColourRed", ALL_VERSIONS},
            {"ClearColourGreen", ALL_VERSIONS},
            {"ClearColourBlue", ALL_VERSIONS},
            {"ClearColourAlpha", ALL_VERSIONS},
            {"Env Footer",  RemoveVersionsFromArray(ALL_VERSIONS, [17842688,17842768,17843456,17843712])},
            {"Field324", RemoveVersionsFromArray(ALL_VERSIONS, [17842688,17842768,17843456,17843712])},
            {"Field328",[17846608]},
            {"Field32C",[17846608]},
            {"Field330",[17846608]},
            {"Field334",[17846608]},
            {"Field338",[17846608]},
        };

        private static uint[] RemoveVersionsFromArray(uint[] versionArray, uint[] versionsToRemove)
        {
            // Create a new array as a copy
            uint[] newVersionArray = versionArray.Where(x => !versionsToRemove.Contains(x)).ToArray();
            return newVersionArray;
        }
    }
}
